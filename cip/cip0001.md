---
author: "Neil D. Lawrence"
created: "2025-11-22"
id: "0001"
last_updated: "2025-11-22"
status: proposed
tags:
- cip
- validation
- refactor
- quantum-game
title: "Consolidate and Document Quantum Inaccessible Game Validation Code"
---

# CIP-0001: Consolidate and Document Quantum Inaccessible Game Validation Code

## Summary

The current Python code for the quantum inaccessible game is spread across several modules (`inaccessible_game_quantum.py`, `advanced_analysis.py`, `validate_qutrit_optimality.py`, and `test_inaccessible_game.py`), plus accompanying documentation (`README_VALIDATION.md`, `QUICKSTART.md`, `TESTING.md`, `CODE_SUMMARY.md`, `IMPLEMENTATION_SUMMARY.md`).  
This CIP proposes to:

- Systematically **document the existing functionality and tests**.
- Introduce a **clear module structure and public API** for the quantum game code.
- Consolidate overlapping functionality and remove ad hoc experimental code paths.
- Make it easier to extend, test, and re-use the code when the paper evolves.

## Motivation

The quantum validation code was developed iteratively to support the paper *The Origin of the Inaccessible Game*. As a result:

- Core functionality (state preparation, operator bases, exponential family, constrained dynamics) lives alongside exploratory or experimental code (e.g. early qutrit optimality scripts).
- Tests cover many behaviours, but the mapping “which tests validate which behaviours” is not documented in one place.
- There is no explicit “library-style” API; scripts mix core logic, analysis, plotting, and CLI behaviour.

For future work (e.g. extending to new dimensions, alternate constraints, or different time parametrisations), we want:

- A **clean separation** between:
  - core quantum game logic;
  - analysis/visualisation;
  - numerical experiments for specific claims;
  - test harnesses.
- A **single place** where existing functionality and tests are described at a high level.

This will make the codebase easier to maintain, review, and re-use (for example, when referees request additional experiments, or when new collaborators join).

## Detailed Description

The existing codebase for the quantum inaccessible game includes at least the following components:

- `inaccessible_game_quantum.py`
  - Quantum state utilities (density matrices, von Neumann entropy, partial traces).
  - Operator bases (Pauli, Gell-Mann, and generalised Gell-Mann-like bases).
  - Quantum exponential family (`QuantumExponentialFamily`) and BKM/Fisher information.
  - Constrained dynamics (`InaccessibleGameDynamics`) supporting different time parametrisations (affine game time, entropy time, etc.).
- `advanced_analysis.py`
  - Higher-level analysis routines for:
    - comparing time parametrisations;
    - tracking GENERIC evolution (symmetric vs antisymmetric parts);
    - exploring qutrit vs qubit behaviour.
  - Mainly used as a script-like module for numerical experiments and visualisation.
- `validate_qutrit_optimality.py`
  - Experimental code for probing the qutrit optimality claim numerically.
  - Contains slow Fisher information computations and diagnostic output.
  - Partially exploratory and currently limited by numerical stability/speed.
- `test_inaccessible_game.py`
  - Comprehensive test suite for:
    - quantum state utilities and operator bases;
    - exponential family properties and BKM metric behaviour;
    - constrained dynamics (tangency, constraint preservation, entropy monotonicity);
    - GENERIC decomposition properties;
    - regression-style checks on small systems (2 qubits, 2 qutrits, 3 qutrits).
  - Includes fast tests and a set of `@pytest.mark.slow` integration/validation tests.

Supporting documentation:

- `README_VALIDATION.md`, `QUICKSTART.md`, `TESTING.md`, `CODE_SUMMARY.md`, `IMPLEMENTATION_SUMMARY.md`.
  - Describe at a high level what the code does, how to run the tests, how to run the validation experiments, and how the implementation matches the paper.

The aim of this CIP is to:

1. **Inventory and stabilise existing functionality**
   - Produce a concise, code-centric overview of:
     - modules and their responsibilities;
     - main classes/functions and their public APIs;
     - which tests validate which behaviours.
2. **Consolidate and simplify module structure**
   - Factor the code into a small number of clearly named modules, for example:
     - `qig/core.py` – core data structures and utilities (states, entropy, partial trace).
     - `qig/exponential_family.py` – `QuantumExponentialFamily` and BKM metric.
     - `qig/dynamics.py` – `InaccessibleGameDynamics`, time parametrisations, GENERIC decomposition.
     - `qig/analysis.py` – high-level analysis helpers used by scripts and notebooks.
   - Move script-like behaviour (CLI argument parsing, plotting, printing) into separate files under a `scripts/` or `experiments/` directory.
3. **Align tests with the refactored layout**
   - Make sure `test_inaccessible_game.py` (or a reorganised test package) still:
     - covers all critical behaviours (state utilities, operator bases, metrics, dynamics, GENERIC structure);
     - marks truly slow tests with `@pytest.mark.slow`;
     - documents, at the top of the file, the mapping from test classes/sections to modules/features.
4. **Update documentation to match the new structure**
   - Refresh `README_VALIDATION.md`, `QUICKSTART.md`, and `TESTING.md` so that:
     - module names and paths match the refactored code;
     - example commands use the new script locations and recommended workflows;
     - links to specific tests and functions point at the consolidated API.

## Implementation Plan

1. **Create a module layout and move core code**
   - Introduce a Python package namespace, e.g. `qig/` for quantum inaccessible game (or similar).
   - Move:
     - core utilities from `inaccessible_game_quantum.py` into `qig/core.py`;
     - exponential-family and metric code into `qig/exponential_family.py`;
     - constrained dynamics and GENERIC support into `quantum_game/dynamics.py`.
   - Leave `inaccessible_game_quantum.py` as a thin legacy wrapper (for backward compatibility) that imports from the new modules, or deprecate it with a clear note.

2. **Refactor analysis and experiment scripts**
   - Move reusable analysis functions from `advanced_analysis.py` into `qig/analysis.py`.
   - Turn `advanced_analysis.py` and `validate_qutrit_optimality.py` into:
     - thin CLI scripts in `scripts/` that call the core library;
     - or Jupyter notebooks that import from `qig/*` for exploratory work.
   - Clearly separate “library code” from “one-off numerical experiments”.

3. **Review and reorganise tests**
   - Survey `test_inaccessible_game.py` and document, in comments at the top:
     - which parts of the code each test section targets.
   - Optionally split into multiple files, e.g.:
     - `test_states_and_operators.py`
     - `test_exponential_family.py`
     - `test_dynamics_and_generic.py`
     - `test_validation_workflows.py`
   - Ensure that:
     - fast tests remain under `-m "not slow"`;
     - slow integration/validation tests are clearly marked and can be skipped by default.

4. **Update documentation**
   - Update `README_VALIDATION.md`, `QUICKSTART.md`, `TESTING.md`, `CODE_SUMMARY.md`, and `IMPLEMENTATION_SUMMARY.md` to:
     - reflect the new package layout and public APIs;
     - list the main entry points (classes/functions) and what they implement from the paper;
     - cross-reference the relevant tests for each major feature.

5. **Housekeeping and cleanup**
   - Remove or deprecate any dead code paths uncovered during the refactor.
   - Ensure that British English spellings remain consistent after renaming/moving.
   - Run the full test suite (fast + `slow`) and update any numerical tolerances if refactoring changes behaviour only within acceptable numerical error.

## Backward Compatibility

This refactor is mostly internal and aimed at improving structure and clarity. However:

- If external users are importing directly from `inaccessible_game_quantum.py`, we should:
  - either keep that file as a thin wrapper re-exporting the new modules;
  - or add a clear deprecation notice and a simple migration guide.
- CLI entry points (e.g. `python validate_qutrit_optimality.py`) may move to a `scripts/` directory; we should:
  - update all docs to point to the new locations;
  - consider adding a small wrapper script for backward compatibility if needed.

Overall, backward compatibility can be preserved with minimal shims and clear documentation.

## Testing Strategy

- Ensure that the existing tests in `test_inaccessible_game.py` (and any split-out test files) continue to pass after refactoring:
  - run `pytest -m "not slow"` frequently during refactor;
  - periodically run the full suite including `@pytest.mark.slow` tests.
- Add targeted tests if any new public API surface appears (e.g. new helper functions in `quantum_game/analysis.py`).
- Use CI (if available) or at least a consistent local test command documented in `TESTING.md`.

## Related Requirements

This CIP addresses the following high-level needs:

- Make the quantum inaccessible game codebase easier to understand and extend.
- Provide a clear mapping from paper statements to implementation and tests.
- Reduce friction when adding new numerical experiments or responding to referee requests.
- Prepare the ground for more advanced geometric work (analytic BKM metric, full Jacobian,
  higher-order cumulants) and their supporting documentation.

Specific requirements implemented by this CIP include:

- A documented and stable module structure for the quantum game code.
- A clear separation between core library functionality and experiment/analysis scripts.
- A documented test plan tied to specific features of the implementation.

## Implementation Status

- [x] Agree on final package/module naming (`qig` for the quantum inaccessible game).
- [x] Move initial core logic (state utilities and entropy helpers) into package modules and keep legacy wrappers as needed.
- [x] Migrate the main library classes (`QuantumExponentialFamily`, `InaccessibleGameDynamics`) into `qig.exponential_family` and `qig.dynamics`, keeping `inaccessible_game_quantum.py` as a thin legacy wrapper.
- [x] Refactor core analysis/experiment scripts (`advanced_analysis.py`, `validate_qutrit_optimality.py`) to use the new `qig` API.
- [ ] Reorganise tests and ensure they all pass after refactoring.
- [ ] Update all validation-related documentation to match the new structure.

## References

- Code:
  - `inaccessible_game_quantum.py`, `advanced_analysis.py`, `validate_qutrit_optimality.py`, `test_inaccessible_game.py`.
  - `qig/core.py`, `qig/exponential_family.py`, `qig/dynamics.py`, `qig/analysis.py`.
- Documentation:
  - `README_VALIDATION.md`, `QUICKSTART.md`, `TESTING.md`, `CODE_SUMMARY.md`, `IMPLEMENTATION_SUMMARY.md`.
  - *The Origin of the Inaccessible Game* (current LaTeX draft).
- Backlog (closely related follow-on work):
  - `2025-11-22_remove-numerical-gradients` (replace finite-difference gradients in the core library).
  - `2025-11-22_full-jacobian-and-third-order-cumulants` (analytic full Jacobian and higher-order geometry).
  - `2025-11-22_qig-docs-and-tests-refactor` (documentation and test narrative refactor for the `qig` layout).


