---
author: "Neil D. Lawrence"
created: "2025-12-01"
id: "0005"
last_updated: "2025-12-01"
status: proposed
tags:
- cip
- documentation
- infrastructure
- sphinx
- readthedocs
title: "Sphinx Documentation and Read the Docs Integration"
---

# CIP-0005: Sphinx Documentation and Read the Docs Integration

## Summary

Set up comprehensive documentation using Sphinx with automatic API reference generation and host it on Read the Docs, providing professional, searchable documentation for the qig package.

## Motivation

The qig package currently has documentation scattered across:
- `README.md` - basic API documentation
- `TESTING.md` - testing documentation
- `NOTEBOOK_OUTPUT_FILTERING.md` and `NOTEBOOK_TEST_FIXES.md` - development notes
- Docstrings in source code
- Example notebooks in `examples/`

While this provides good information, it lacks

1. **Centralized, searchable documentation** - users must navigate multiple files
2. **Professional API reference** - auto-generated from docstrings
3. **Mathematical equation rendering** - critical for quantum information geometry
4. **Integrated examples** - notebooks embedded in documentation
5. **Version-specific docs** - Read the Docs provides versioned documentation
6. **Discoverability** - standard documentation URLs improve project visibility

## Detailed Description

### Sphinx Setup

Sphinx is the standard documentation tool for Python scientific packages. It provides

- **Autodoc**: Automatic API documentation from docstrings
- **Napoleon**: Support for NumPy/Google style docstrings
- **Math support**: LaTeX equation rendering via MathJax
- **nbsphinx**: Jupyter notebook integration
- **Cross-references**: Automatic linking between docs and code

### Read the Docs Integration

Read the Docs (readthedocs.org) provides

- Free hosting for open source projects
- Automatic builds on every commit
- Version-specific documentation (latest, stable, v0.1.0, etc.)
- Search functionality
- PDF/ePub export
- Custom domains (optional)

### Documentation Structure
```
docs/
├── source/
│   ├── conf.py                 # Sphinx configuration
│   ├── index.rst               # Main landing page
│   ├── installation.rst        # Installation guide
│   ├── quickstart.rst          # Quick start tutorial
│   ├── user_guide/
│   │   ├── index.rst           # User guide overview
│   │   ├── exponential_families.rst
│   │   ├── dynamics.rst
│   │   ├── constraints.rst
│   │   └── advanced.rst
│   ├── api/
│   │   ├── index.rst           # API reference overview
│   │   ├── core.rst            # qig.core documentation
│   │   ├── exponential_family.rst
│   │   ├── dynamics.rst
│   │   ├── pair_operators.rst
│   │   ├── duhamel.rst
│   │   └── analysis.rst
│   ├── examples/
│   │   ├── index.rst           # Examples overview
│   │   └── notebooks/          # Embedded notebooks
│   ├── theory/
│   │   ├── index.rst           # Theory overview
│   │   ├── quantum_exponential_families.rst
│   │   ├── fisher_information.rst
│   │   ├── inaccessible_game.rst
│   │   └── generic_structure.rst
│   ├── development/
│   │   ├── index.rst           # Development guide
│   │   ├── testing.rst         # From TESTING.md
│   │   ├── testing_tolerances.rst  # Numerical testing tolerance framework docs
│   │   ├── contributing.rst    # From CONTRIBUTING.md
│   │   └── notebooks.rst       # Notebook development notes
│   └── references.rst          # Bibliography and citations
├── requirements.txt            # Documentation dependencies
└── Makefile                    # Build commands

.readthedocs.yaml               # Read the Docs configuration
```

### Key Features to Include

1. **Mathematical Content**
   - Quantum state equations: ρ(θ) = exp(Σᵢθᵢ Fᵢ - ψ(θ))
   - BKM metric: G_ab = Tr(ρ ∂_a H ∂_b H)
   - Constraint manifolds: C(θ) = Σᵢ hᵢ(θ) = const
   - GENERIC decomposition

2. **Code Examples**
   - Inline code snippets with syntax highlighting
   - Full working examples
   - Output visualization

3. **API Documentation**
   - Class and function signatures
   - Parameter descriptions
   - Return value documentation
   - Usage examples
   - Related functions

4. **Interactive Elements**
   - Embedded Jupyter notebooks
   - Links to Google Colab
   - Downloadable example code

## Implementation Plan

### Phase 1: Basic Sphinx Setup (2-3 hours)

1. **Install Dependencies**:
   ```bash
   pip install sphinx sphinx-rtd-theme sphinx-autodoc-typehints
   pip install nbsphinx pandoc
   ```

2. **Initialise Sphinx**:
   ```bash
   cd /Users/neil/lawrennd/qig-code
   sphinx-quickstart docs
   ```
   - Configure for separate source and build directories
   - Enable autodoc extension
   - Enable napoleon extension for NumPy-style docstrings

3. **Configure conf.py**:
   - Set up extensions: autodoc, napoleon, mathjax, nbsphinx
   - Configure theme: sphinx_rtd_theme
   - Set up paths to qig package
   - Configure autodoc options

4. **Create Basic Structure**:
   - Write `index.rst` with project overview
   - Create `installation.rst` from README
   - Create `quickstart.rst` from README quick start
   - Create `api/index.rst` with autodoc directives

### Phase 2: Content Migration (2-3 hours)

1. **Migrate Existing Documentation**:
   - Convert TESTING.md → `development/testing.rst`
   - Convert CONTRIBUTING.md → `development/contributing.rst`
   - Extract API docs from README → `api/*.rst` files
   - Convert notebook docs → `development/notebooks.rst`
   - **Numerical testing tolerance docs** → `development/testing_tolerances.rst` (see backlog: `2025-12-01_cip0004-documentation-completion.md`)

2. **Create API Reference**:
   - `api/core.rst`: Document qig.core module
   - `api/exponential_family.rst`: QuantumExponentialFamily class
   - `api/dynamics.rst`: InaccessibleGameDynamics class
   - `api/pair_operators.rst`: Operator basis functions
   - `api/duhamel.rst`: Duhamel formula implementation
   - `api/analysis.rst`: Analysis utilities

3. **Add Theory Section**:
   - Explain quantum exponential families
   - Document BKM metric and Fisher information
   - Describe the inaccessible game framework
   - Explain GENERIC structure

### Phase 3: Read the Docs Integration (1 hour)

1. **Create .readthedocs.yaml**:
   ```yaml
   version: 2
   
   build:
     os: ubuntu-22.04
     tools:
       python: "3.11"
   
   python:
     install:
       - requirements: docs/requirements.txt
       - method: pip
         path: .
   
   sphinx:
     configuration: docs/source/conf.py
   
   formats:
     - pdf
     - epub
   ```

2. **Create docs/requirements.txt**:
   ```
   sphinx>=7.0
   sphinx-rtd-theme>=1.3
   sphinx-autodoc-typehints>=1.24
   nbsphinx>=0.9
   pandoc>=2.3
   ipykernel>=6.0
   matplotlib>=3.4.0
   numpy>=1.21.0
   scipy>=1.7.0
   ```

3. **Connect to Read the Docs**:
   - Sign in to readthedocs.org with GitHub
   - Import qig-code repository
   - Configure build settings
   - Enable PDF/ePub builds

### Phase 4: Enhancement and Polish (2-3 hours)

1. **Embed Example Notebooks**:
   - Configure nbsphinx for notebook rendering
   - Add `examples/notebooks/` with documentation notebooks
   - Link to Colab for interactive execution

2. **Improve Docstrings**:
   - Audit key functions for docstring completeness
   - Add mathematical descriptions where appropriate
   - Include usage examples in docstrings
   - Add cross-references between related functions

3. **Add Search and Navigation**:
   - Configure intersphinx for linking to NumPy/SciPy docs
   - Add glossary of terms
   - Create comprehensive index
   - Add bibliography for citations

4. **Testing and Review**:
   - Build docs locally: `make html`
   - Check for warnings and errors
   - Verify all links work
   - Test on multiple browsers
   - Review on Read the Docs preview

## Backward Compatibility

This change is purely additive and does not affect the package API or behavior:
- Existing README.md remains as GitHub landing page
- Source code remains unchanged (except improved docstrings)
- All existing documentation files remain in place
- Documentation dependencies are optional (docs/requirements.txt)

## Testing Strategy

### Build Tests

```bash
# Local build test
cd docs
make clean
make html
# Check build output for warnings

# Test all formats
make html
make latex
make epub
```

### Content Tests

- [ ] All API functions documented
- [ ] All code examples run without errors
- [ ] Mathematical equations render correctly
- [ ] Internal links work
- [ ] External links (NumPy, SciPy) work
- [ ] Search functionality works
- [ ] Mobile responsive design

### CI Integration

Add to GitHub Actions workflow:
```yaml
- name: Build documentation
  run: |
    pip install -r docs/requirements.txt
    cd docs
    make html
```

## Related Requirements

This CIP addresses documentation and infrastructure needs:
- Improves package discoverability and professional presentation
- Makes API easier to understand and use
- Provides theoretical background for quantum information geometry
- Consolidates scattered documentation

Related to:
- **CIP-0001**: Consolidation and documentation efforts
- **CIP-0004**: Test suite tolerance framework documentation should be integrated into Sphinx
- **Backlog**: `backlog/documentation/2025-11-22_qig-docs-and-tests-refactor.md`
- **Backlog**: `backlog/documentation/2025-12-01_cip0004-documentation-completion.md` - Tolerance framework docs to integrate

## Implementation Status

- [x] Phase 1: Basic Sphinx setup ✅ **COMPLETED**
  - [x] Install Sphinx and dependencies (sphinx, sphinx-rtd-theme, nbsphinx, autodoc-typehints)
  - [x] Run sphinx-quickstart with separate source/build directories
  - [x] Configure conf.py with extensions (autodoc, napoleon, mathjax, nbsphinx, intersphinx)
  - [x] Create basic directory structure (api/, user_guide/, theory/, development/)
  - [x] Create initial rst files (index, installation, quickstart, section indexes)
  - [x] Successful build with `make html` (57 warnings for missing content - expected)
- [ ] Phase 2: Content migration
  - [ ] Migrate existing docs (TESTING.md, CONTRIBUTING.md, notebook docs)
  - [ ] Integrate CIP-0004 tolerance documentation (backlog: `2025-12-01_cip0004-documentation-completion.md`)
  - [ ] Create API reference pages
  - [ ] Write theory section
- [ ] Phase 3: Read the Docs integration
  - [ ] Create .readthedocs.yaml
  - [ ] Create docs/requirements.txt
  - [ ] Connect repository to Read the Docs
  - [ ] Verify builds work
- [ ] Phase 4: Enhancement and polish
  - [ ] Embed example notebooks
  - [ ] Improve docstrings
  - [ ] Add search and navigation
  - [ ] Testing and review

## References

- Sphinx documentation: https://www.sphinx-doc.org/
- Read the Docs documentation: https://docs.readthedocs.io/
- Sphinx autodoc: https://www.sphinx-doc.org/en/master/usage/extensions/autodoc.html
- Napoleon extension: https://www.sphinx-doc.org/en/master/usage/extensions/napoleon.html
- nbsphinx: https://nbsphinx.readthedocs.io/
- Example scientific Python docs:
  - NumPy: https://numpy.org/doc/
  - SciPy: https://docs.scipy.org/
  - scikit-learn: https://scikit-learn.org/stable/documentation.html

## Notes

- Consider adding a "Gallery" section showcasing visualisations
- May want to add a "FAQ" section based on common questions
- Could include a "Publications" page linking to papers using qig
- Future: Consider adding interactive widgets for parameter exploration

